# Задача про две коробки с шарами

Есть 2 коробки. В одной находится 8 шаров, из которых 5 белые, остальные чёрные. Во второй 12 шаров, из которых 5 белые. Из первой коробки вытащили 2 случайных шара. Из второй коробки вытащили 4 случайных шара. Найти вероятность того, что в получившейся выборке будет ровно 3 белых шара.

## Решение через перебор всех вариантов

Количество шаров в коробоках непрерывно меняется. А следовательно, изменяется и вероятность получить белый. Поэтому необходимо вручную пересчитать вероятность каждого возможного исхода. Для этого сделаем таблицу, в которой "+" - это белые шары:

| 1 | 1 | 2 | 2 | 2 | 2 |
|---|---|---|---|---|---|
| + | + | + | - | - | - |
| + | - | + | + | - | - |
| - | + | + | + | - | - |
| - | - | + | + | + | - |
| - | - | + | - | + | + |
| - | - | + | + | - | + |
| - | - | - | + | + | + |
| + | + | - | + | - | - |
| + | + | - | - | + | - |
| + | + | - | - | - | + |
| + | - | + | - | + | - |
| + | - | + | - | - | + |
| + | - | - | + | - | + |
| + | - | - | - | + | + |
| + | - | - | + | + | - |
| - | + | + | - | + | - |
| - | + | + | - | - | + |
| - | + | - | + | - | + |
| - | + | - | - | + | + |
| - | + | - | + | + | - |

Вероятность получить 3 шара из шести равна количеству комбинаций 6!/(3!*(6-3)!) = 20. 

Начальная вероятность достать белый шар из первой коробки - 5/8, а черный - 3/8.
Начальная вероятность достать белый шар из второй коробки - 5/12, а черный - 7/12.

Вероятность получить чёрный шар = (1 - вероятность получить белый). При этом количество шаров (число в знаменателе) постоянно убывает, потому что шары изымаются из коробок. То есть если достаём первой коробки шар, то вероятность получить белый 5/8, а на следующий шар вероятность станет 4/7. Аналогично вероятность достать из неё же чёрный изменится на с 3/8 на 3/7.

Теперь если идти по полученной таблице построчно, заменяя плюсы на вероятность получения белого шара, а минусы на вероятность получения чёрного, то можно получить такую таблицу:

| 1   | 1   | 2    | 2    | 2    | 2   | 
|-----|-----|------|------|------|-----|
| 5/8 | 4/7 | 5/12 | 7/11 | 6/10 | 5/9 |
| 5/8 | 3/7 | 5/12 | 4/11 | 7/10 | 6/9 |
| 3/8 | 5/7 | 5/12 | 4/11 | 7/10 | 6/9 |
| 3/8 | 2/7 | 5/12 | 4/11 | 3/10 | 7/9 |
| 3/8 | 2/7 | 5/12 | 7/11 | 4/10 | 3/9 |
| 3/8 | 2/7 | 5/12 | 4/11 | 7/10 | 3/9 |
| 3/8 | 2/7 | 7/12 | 5/11 | 4/10 | 3/9 |
| 5/8 | 4/7 | 7/12 | 5/11 | 6/10 | 5/9 |
| 5/8 | 4/7 | 7/12 | 6/11 | 5/10 | 5/9 |
| 5/8 | 4/7 | 7/12 | 6/11 | 5/10 | 5/9 |
| 5/8 | 3/7 | 5/12 | 7/11 | 4/10 | 6/9 |
| 5/8 | 3/7 | 5/12 | 7/11 | 6/10 | 4/9 |
| 5/8 | 3/7 | 7/12 | 5/11 | 6/10 | 4/9 |
| 5/8 | 3/7 | 7/12 | 6/11 | 5/10 | 4/9 |
| 5/8 | 3/7 | 7/12 | 5/11 | 4/10 | 6/9 |
| 3/8 | 5/7 | 5/12 | 7/11 | 4/10 | 6/9 |
| 3/8 | 5/7 | 5/12 | 7/11 | 6/10 | 4/9 |
| 3/8 | 5/7 | 7/12 | 5/11 | 6/10 | 4/9 |
| 3/8 | 5/7 | 7/12 | 6/11 | 5/10 | 4/9 |
| 3/8 | 5/7 | 7/12 | 5/11 | 4/10 | 6/9 |

Эта таблица состоит только из вероятностей случаев, в которых 3 из 6 шаров оказались белыми. Теперь если перемножить все значения в каждой строке, а потом сложить все эти результаты, то получим полную вероятность события. Она составит 0,368686868686869

Это решение с помощью простого перебора всех вариантов вручную. Но чтобы не трудиться, можно всё запрограммировать. Далее приведен разбор кода автоматизации задачи на Python и оценки методом Монте-Карло на языке R.

## Python

Скоро будет...

## R

```R
    # первая коробка содержит 5 (они же единицы "1") белых шаров и 3 чёрных (они же нули "0"). Всего 8 шаров
    a <- (1, 1, 1, 1, 1, 0, 0, 0)
    
    # вторая коробка содержит 5 из 12 белых
    b <- (1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0)
   
   
    # берём из первой коробки 2 случайных, из второй - 4
    sam.a <- sample(a, 2)
    sam.b <- sample(b, 4)
   
    # складываем полученные в одну кучу (сложение векторов функцией "c") и суммируем белые
    s <- sum(c(sam.b, sam.b))
    
    # По условию задачи мы хотим найти вероятности, с которой вытащим ровно 3 белых. То есть нужно посчитать вероятность получить в переменной "s" число 3. Но при выполнении этого кода там может оказаться любое число от 0 до 6. Поэтому нам нужно запустить код очень много раз и узнать, с какой вероятностью выпадает число 3. 
    
    # Для удобства обернём код в функцию:
    mc <- function(a, b){
        sam.a <- sample(a, 2)
        sam.b <- sample(b, 4)
        s <- sum(c(sam.b, sam.b))
        return s
    }
    
    # И выполним её миллион раз:
    m <- replicate(1000000, mc(a, b))
    
    # В переменную "m" будет записана последовательности из сотни возможных значений "s". Остаётся только посчитать долю значений, которые равны 3, что и просят сделать в задании.
    
    mean(m == 3) # сначала сравниваем каждое число из выборки с 3 и возвращаем список из True / False. Затем функция mean суммирует все 1 (они же True) и делит на общее количество элементов
    
    # получим число 0,368149, что до третьего порядка после запятой совпадает с теоретическим значением 0,368686868686869
    
    # Для понимания зависимости точности от количества повторений сделаем повтор только 100 раз:
    m <- replicate(100, mc(a, b))
    mean(m == 3) # получим значение 0.31
```
